# process and add Radiographics review papers
import parser_RadioGraphics as parser

import mechanize
import cookielib
from bs4 import BeautifulSoup
from time import time
from time import sleep
from random import randint
import sys
import cPickle as pickle
import zlib
from main.models import *
from nltk.tokenize import sent_tokenize
from scipy.sparse import coo_matrix, csr_matrix, vstack
from scipy import int16
from numpy import array
import re2
from django.core.files.storage import default_storage
import uuid
import traceback
import urllib2

'''pickle and compress obj'''
def pickle_zdumps(obj):
    return zlib.compress(pickle.dumps(obj,pickle.HIGHEST_PROTOCOL),9)

'''unpickle and decompress obj'''
def pickle_zloads(zstr):
    return pickle.loads(zlib.decompress(zstr))

def run():

    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    start = time()
    # Browser
    br = mechanize.Browser()
    # Cookie Jar
    cj = cookielib.LWPCookieJar()
    br.set_cookiejar(cj)
    # Browser options
    br.set_handle_equiv(True)
    #br.set_handle_gzip(True)
    br.set_handle_redirect(True)
    br.set_handle_referer(True)
    br.set_handle_robots(False)
    # Follows refresh 0 but not hangs on refresh > 0
    br.set_handle_refresh(mechanize._http.HTTPRefreshProcessor(), max_time=1)
    # Want debugging messages?
    #br.set_debug_http(True)
    #br.set_debug_redirects(True)
    #br.set_debug_responses(True)
    # User-Agent
    br.addheaders = [('User-Agent', 'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64 Safari/537.11')]
    print "initiated browser: " + str(time()-start) + " seconds"
    
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    # PMIDs and DOIs of RadioGraphics review articles from 2003/01 to 2013/01
    identifiers = [{"pmid":17620476,"doi":"10.1148/rg.274065090"},{"pmid":17620478,"doi":"10.1148/rg.274065115"},{"pmid":17848688,"doi":"10.1148/rg.275065172"},{"pmid":17848689,"doi":"10.1148/rg.275065176"},{"pmid":17848691,"doi":"10.1148/rg.275065189"},{"pmid":17848692,"doi":"10.1148/rg.275065107"},{"pmid":17848693,"doi":"10.1148/rg.275065737"},{"pmid":17848694,"doi":"10.1148/rg.275065148"},{"pmid":17848695,"doi":"10.1148/rg.275065157"},{"pmid":17848696,"doi":"10.1148/rg.275065729"},{"pmid":17848697,"doi":"10.1148/rg.275065151"},{"pmid":17848698,"doi":"10.1148/rg.275065163"},{"pmid":17848699,"doi":"10.1148/rg.275065129"},{"pmid":17848700,"doi":"10.1148/rg.275065021"},{"pmid":17848702,"doi":"10.1148/rg.275065204"},{"pmid":17848703,"doi":"10.1148/rg.275075116"},{"pmid":17848705,"doi":"10.1148/rg.275075045"},{"pmid":17848707,"doi":"10.1148/rg.275075159"},{"pmid":17848708,"doi":"10.1148/rg.275065139"},{"pmid":17967936,"doi":"10.1148/radiol.e28"},{"pmid":18025502,"doi":"10.1148/rg.276075003"},{"pmid":18025503,"doi":"10.1148/rg.276065747"},{"pmid":18025504,"doi":"10.1148/rg.276075004"},{"pmid":18025505,"doi":"10.1148/rg.276065002"},{"pmid":18025507,"doi":"10.1148/rg.276065170"},{"pmid":18025508,"doi":"10.1148/rg.276065742"},{"pmid":18025509,"doi":"10.1148/rg.276075034"},{"pmid":18025510,"doi":"10.1148/rg.276075001"},{"pmid":18025511,"doi":"10.1148/rg.276075027"},{"pmid":18025512,"doi":"10.1148/rg.276075028"},{"pmid":18025513,"doi":"10.1148/rg.276075002"},{"pmid":18025515,"doi":"10.1148/rg.276065205"},{"pmid":18025516,"doi":"10.1148/rg.276065509"},{"pmid":18025517,"doi":"10.1148/rg.276075138"},{"pmid":18025519,"doi":"10.1148/rg.276075097"},{"pmid":18025520,"doi":"10.1148/rg.276075096"},{"pmid":18025521,"doi":"10.1148/rg.276075120"},{"pmid":18180221,"doi":"10.1148/rg.27si075505"},{"pmid":18180223,"doi":"10.1148/rg.27si075514"},{"pmid":18180224,"doi":"10.1148/rg.27si075516"},{"pmid":18180225,"doi":"10.1148/rg.27si075503"},{"pmid":18180226,"doi":"10.1148/rg.27si075501"},{"pmid":18180227,"doi":"10.1148/rg.27si075507"},{"pmid":18180228,"doi":"10.1148/rg.27si075517"},{"pmid":18180229,"doi":"10.1148/rg.27si075511"},{"pmid":18180230,"doi":"10.1148/rg.27si075504"},{"pmid":18180231,"doi":"10.1148/rg.27si075519"},{"pmid":18180233,"doi":"10.1148/rg.27si075510"},{"pmid":18180235,"doi":"10.1148/rg.27si075508"},{"pmid":18180236,"doi":"10.1148/rg.27si075512"},{"pmid":18180237,"doi":"10.1148/rg.27si075515"},{"pmid":18180238,"doi":"10.1148/rg.27si075502"},{"pmid":18203929,"doi":"10.1148/rg.281075077"},{"pmid":18203930,"doi":"10.1148/rg.281075065"},{"pmid":18203931,"doi":"10.1148/rg.281075052"},{"pmid":18203932,"doi":"10.1148/rg.281065721"},{"pmid":18203933,"doi":"10.1148/rg.281075115"},{"pmid":18203934,"doi":"10.1148/rg.281075058"},{"pmid":18203935,"doi":"10.1148/rg.281065183"},{"pmid":18203936,"doi":"10.1148/rg.281065188"},{"pmid":18203937,"doi":"10.1148/rg.281075037"},{"pmid":18203938,"doi":"10.1148/rg.281075040"},{"pmid":18203939,"doi":"10.1148/rg.281075049"},{"pmid":18203940,"doi":"10.1148/rg.281075047"},{"pmid":18203941,"doi":"10.1148/rg.281075024"},{"pmid":18203942,"doi":"10.1148/rg.281075171"},{"pmid":18299559,"doi":"10.1148/rg.e29"},{"pmid":18349443,"doi":"10.1148/rg.282075068"},{"pmid":18349445,"doi":"10.1148/rg.282075099"},{"pmid":18349446,"doi":"10.1148/rg.282075038"},{"pmid":18349448,"doi":"10.1148/rg.282075705"},{"pmid":18349449,"doi":"10.1148/rg.282075066"},{"pmid":18349450,"doi":"10.1148/rg.282075060"},{"pmid":18349451,"doi":"10.1148/rg.282075714"},{"pmid":18349452,"doi":"10.1148/rg.282075064"},{"pmid":18349453,"doi":"10.1148/rg.282075061"},{"pmid":18349455,"doi":"10.1148/rg.282075048"},{"pmid":18349456,"doi":"10.1148/rg.282075032"},{"pmid":18349457,"doi":"10.1148/rg.282075709"},{"pmid":18349458,"doi":"10.1148/rg.282075710"},{"pmid":18349460,"doi":"10.1148/rg.282075175"},{"pmid":18426969,"doi":"10.1148/rg.e30"},{"pmid":18480477,"doi":"10.1148/rg.283075050"},{"pmid":18480478,"doi":"10.1148/rg.283075101"},{"pmid":18480479,"doi":"10.1148/rg.283075095"},{"pmid":18480480,"doi":"10.1148/rg.283075108"},{"pmid":18480481,"doi":"10.1148/rg.283065179"},{"pmid":18480482,"doi":"10.1148/rg.283055108"},{"pmid":18480483,"doi":"10.1148/rg.283075085"},{"pmid":18480484,"doi":"10.1148/rg.283075087"},{"pmid":18480485,"doi":"10.1148/rg.283075082"},{"pmid":18480486,"doi":"10.1148/rg.283075110"},{"pmid":18480487,"doi":"10.1148/rg.283075100"},{"pmid":18480488,"doi":"10.1148/rg.283075106"},{"pmid":18480489,"doi":"10.1148/rg.283075091"},{"pmid":18480490,"doi":"10.1148/rg.283075219"},{"pmid":18603663,"doi":"10.1148/rg.e31"},{"pmid":18635620,"doi":"10.1148/rg.284085035"},{"pmid":18635623,"doi":"10.1148/rg.284075139"},{"pmid":18635624,"doi":"10.1148/rg.284075069"},{"pmid":18635625,"doi":"10.1148/rg.284065018"},{"pmid":18635626,"doi":"10.1148/rg.284075157"},{"pmid":18635627,"doi":"10.1148/rg.284075156"},{"pmid":18635628,"doi":"10.1148/rg.284075111"},{"pmid":18635629,"doi":"10.1148/rg.284075122"},{"pmid":18635630,"doi":"10.1148/rg.284075114"},{"pmid":18635631,"doi":"10.1148/rg.284075203"},{"pmid":18635632,"doi":"10.1148/rg.284075148"},{"pmid":18635633,"doi":"10.1148/rg.284075170"},{"pmid":18635634,"doi":"10.1148/rg.284075031"},{"pmid":18635637,"doi":"10.1148/rg.284085013"},{"pmid":18772274,"doi":"10.1148/rg.e32"},{"pmid":18794305,"doi":"10.1148/rg.285075183"},{"pmid":18794306,"doi":"10.1148/rg.285075187"},{"pmid":18794308,"doi":"10.1148/rg.285075089"},{"pmid":18794310,"doi":"10.1148/rg.285075744"},{"pmid":18794311,"doi":"10.1148/rg.285075126"},{"pmid":18794313,"doi":"10.1148/rg.285075212"},{"pmid":18794314,"doi":"10.1148/rg.285075223"},{"pmid":18794315,"doi":"10.1148/rg.285075743"},{"pmid":18794316,"doi":"10.1148/rg.285075217"},{"pmid":18794317,"doi":"10.1148/rg.285075748"},{"pmid":18794318,"doi":"10.1148/rg.285075075"},{"pmid":18794320,"doi":"10.1148/rg.285075055"},{"pmid":18936020,"doi":"10.1148/rg.286085520"},{"pmid":18936021,"doi":"10.1148/rg.286085510"},{"pmid":18936022,"doi":"10.1148/rg.286075141"},{"pmid":18936023,"doi":"10.1148/rg.286085524"},{"pmid":18936024,"doi":"10.1148/rg.286085522"},{"pmid":18936025,"doi":"10.1148/rg.286085507"},{"pmid":18936026,"doi":"10.1148/rg.286085501"},{"pmid":18936027,"doi":"10.1148/rg.286085504"},{"pmid":18936028,"doi":"10.1148/rg.286085506"},{"pmid":18936029,"doi":"10.1148/rg.286085502"},{"pmid":18936030,"doi":"10.1148/rg.286085521"},{"pmid":18936031,"doi":"10.1148/rg.286085512"},{"pmid":18936032,"doi":"10.1148/rg.286085523"},{"pmid":18936033,"doi":"10.1148/rg.286085515"},{"pmid":18936034,"doi":"10.1148/rg.286085503"},{"pmid":18936035,"doi":"10.1148/rg.286085511"},{"pmid":18936036,"doi":"10.1148/rg.286085513"},{"pmid":19001643,"doi":"10.1148/rg.287085055"},{"pmid":19001644,"doi":"10.1148/rg.287085054"},{"pmid":19001646,"doi":"10.1148/rg.287085034"},{"pmid":19001647,"doi":"10.1148/rg.287085060"},{"pmid":19001648,"doi":"10.1148/rg.287075076"},{"pmid":19001649,"doi":"10.1148/rg.287085095"},{"pmid":19001651,"doi":"10.1148/rg.287085031"},{"pmid":19001652,"doi":"10.1148/rg.287085067"},{"pmid":19001653,"doi":"10.1148/rg.287075154"},{"pmid":19001657,"doi":"10.1148/rg.287085135"},{"pmid":19001659,"doi":"10.1148/rg.287085001"},{"pmid":19001660,"doi":"10.1148/rg.287085167"},{"pmid":19168761,"doi":"10.1148/rg.e34"},{"pmid":19270071,"doi":"10.1148/rg.e35"},{"pmid":19270072,"doi":"10.1148/rg.293085226"},{"pmid":19325052,"doi":"10.1148/rg.292085189"},{"pmid":19325053,"doi":"10.1148/rg.292075143"},{"pmid":19325055,"doi":"10.1148/rg.292085123"},{"pmid":19325056,"doi":"10.1148/rg.292085106"},{"pmid":19325057,"doi":"10.1148/rg.292085514"},{"pmid":19325058,"doi":"10.1148/rg.292085136"},{"pmid":19325059,"doi":"10.1148/rg.292085146"},{"pmid":19325060,"doi":"10.1148/rg.292085117"},{"pmid":19325061,"doi":"10.1148/rg.292085070"},{"pmid":19325062,"doi":"10.1148/rg.292085128"},{"pmid":19325063,"doi":"10.1148/rg.292085154"},{"pmid":19325064,"doi":"10.1148/rg.292075080"},{"pmid":19325065,"doi":"10.1148/rg.292085059"},{"pmid":19325066,"doi":"10.1148/rg.292085037"},{"pmid":19325067,"doi":"10.1148/rg.292085078"},{"pmid":19325068,"doi":"10.1148/rg.292085137"},{"pmid":19448105,"doi":"10.1148/rg.294095006"},{"pmid":19448106,"doi":"10.1148/rg.294085073"},{"pmid":19448107,"doi":"10.1148/rg.e36"},{"pmid":19448109,"doi":"10.1148/rg.293085056"},{"pmid":19448110,"doi":"10.1148/rg.293085729"},{"pmid":19448111,"doi":"10.1148/rg.293085115"},{"pmid":19448112,"doi":"10.1148/rg.293085113"},{"pmid":19448113,"doi":"10.1148/rg.293085190"},{"pmid":19448114,"doi":"10.1148/rg.293085130"},{"pmid":19448115,"doi":"10.1148/rg.293085120"},{"pmid":19448116,"doi":"10.1148/rg.293085122"},{"pmid":19448117,"doi":"10.1148/rg.293085715"},{"pmid":19448118,"doi":"10.1148/rg.293085093"},{"pmid":19448119,"doi":"10.1148/rg.293055136"},{"pmid":19448121,"doi":"10.1148/rg.293085517"},{"pmid":19448122,"doi":"10.1148/rg.293085163"},{"pmid":19448123,"doi":"10.1148/rg.293085168"},{"pmid":19448124,"doi":"10.1148/rg.293095010"},{"pmid":19564252,"doi":"10.1148/rg.295095086"},{"pmid":19605651,"doi":"10.1148/rg.294085736"},{"pmid":19605652,"doi":"10.1148/rg.294095020"},{"pmid":19605653,"doi":"10.1148/rg.294085748"},{"pmid":19605654,"doi":"10.1148/rg.294085730"},{"pmid":19605655,"doi":"10.1148/rg.294085743"},{"pmid":19605656,"doi":"10.1148/rg.294085231"},{"pmid":19605657,"doi":"10.1148/rg.294085223"},{"pmid":19605658,"doi":"10.1148/rg.294085737"},{"pmid":19605659,"doi":"10.1148/rg.294085235"},{"pmid":19605661,"doi":"10.1148/rg.294085745"},{"pmid":19605662,"doi":"10.1148/rg.294085032"},{"pmid":19605663,"doi":"10.1148/rg.294085244"},{"pmid":19605664,"doi":"10.1148/rg.294085199"},{"pmid":19734468,"doi":"10.1148/rg.e37"},{"pmid":19755594,"doi":"10.1148/rg.295095151"},{"pmid":19755595,"doi":"10.1148/rg.295085186"},{"pmid":19755596,"doi":"10.1148/rg.295095011"},{"pmid":19755597,"doi":"10.1148/rg.295095003"},{"pmid":19755598,"doi":"10.1148/rg.295095026"},{"pmid":19755599,"doi":"10.1148/rg.295095027"},{"pmid":19755600,"doi":"10.1148/rg.295095047"},{"pmid":19755601,"doi":"10.1148/rg.295085242"},{"pmid":19755602,"doi":"10.1148/rg.295095002"},{"pmid":19755603,"doi":"10.1148/rg.295085183"},{"pmid":19755604,"doi":"10.1148/rg.295095034"},{"pmid":19755605,"doi":"10.1148/rg.295095041"},{"pmid":19755606,"doi":"10.1148/rg.295085247"},{"pmid":19755607,"doi":"10.1148/rg.295095024"},{"pmid":19755608,"doi":"10.1148/rg.295095109"},{"pmid":19926753,"doi":"10.1148/rg.297095717"},{"pmid":19926754,"doi":"10.1148/rg.297095707"},{"pmid":19926755,"doi":"10.1148/rg.297095048"},{"pmid":19926757,"doi":"10.1148/rg.297095050"},{"pmid":19926758,"doi":"10.1148/rg.297095710"},{"pmid":19926767,"doi":"10.1148/rg.297095081"},{"pmid":19959508,"doi":"10.1148/rg.296095517"},{"pmid":19959508,"doi":"10.1148/rg.296095517"},{"pmid":19959508,"doi":"10.1148/rg.296095517"},{"pmid":19959508,"doi":"10.1148/rg.296095517"},{"pmid":19959511,"doi":"10.1148/rg.296095512"},{"pmid":19959511,"doi":"10.1148/rg.296095512"},{"pmid":19959508,"doi":"10.1148/rg.296095517"},{"pmid":19959511,"doi":"10.1148/rg.296095512"},{"pmid":19959511,"doi":"10.1148/rg.296095512"},{"pmid":19959511,"doi":"10.1148/rg.296095512"},{"pmid":20083597,"doi":"10.1148/rg.301095092"},{"pmid":20083597,"doi":"10.1148/rg.301095092"},{"pmid":20083597,"doi":"10.1148/rg.301095092"},{"pmid":20083597,"doi":"10.1148/rg.301095092"},{"pmid":20083597,"doi":"10.1148/rg.301095092"},{"pmid":20083597,"doi":"10.1148/rg.301095092"},{"pmid":20228322,"doi":"10.1148/rg.302095741"},{"pmid":20228323,"doi":"10.1148/rg.302095028"},{"pmid":20228324,"doi":"10.1148/rg.302095113"},{"pmid":20228326,"doi":"10.1148/rg.302095131"},{"pmid":20228327,"doi":"10.1148/rg.302095734"},{"pmid":20228321,"doi":"10.1148/rg.302095124"},{"pmid":20228328,"doi":"10.1148/rg.302095104"},{"pmid":20228332,"doi":"10.1148/rg.302095080"},{"pmid":20228329,"doi":"10.1148/rg.302095115"},{"pmid":20228333,"doi":"10.1148/rg.302095044"},{"pmid":20228330,"doi":"10.1148/rg.302095728"},{"pmid":20228325,"doi":"10.1148/rg.302095112"},{"pmid":20228334,"doi":"10.1148/rg.302095097"},{"pmid":20228331,"doi":"10.1148/rg.302095046"},{"pmid":20622191,"doi":"10.1148/rg.e42"},{"pmid":20622191,"doi":"10.1148/rg.e42"},{"pmid":20622191,"doi":"10.1148/rg.e42"},{"pmid":20631359,"doi":"10.1148/rg.304095745"},{"pmid":20631359,"doi":"10.1148/rg.304095745"},{"pmid":20833845,"doi":"10.1148/rg.305095144"},{"pmid":20833845,"doi":"10.1148/rg.305095144"},{"pmid":20833845,"doi":"10.1148/rg.305095144"},{"pmid":20980666,"doi":"10.1148/rg.311105018"},{"pmid":20980666,"doi":"10.1148/rg.311105018"},{"pmid":20980666,"doi":"10.1148/rg.311105018"},{"pmid":20980666,"doi":"10.1148/rg.311105018"},{"pmid":21057119,"doi":"10.1148/rg.307105710"},{"pmid":21057119,"doi":"10.1148/rg.307105710"},{"pmid":21057119,"doi":"10.1148/rg.307105710"},{"pmid":21057119,"doi":"10.1148/rg.307105710"},{"pmid":21071369,"doi":"10.1148/rg.306105523"},{"pmid":21071369,"doi":"10.1148/rg.306105523"},{"pmid":21071372,"doi":"10.1148/rg.306105513"},{"pmid":21071374,"doi":"10.1148/rg.306105503"},{"pmid":21071369,"doi":"10.1148/rg.306105523"},{"pmid":21071374,"doi":"10.1148/rg.306105503"},{"pmid":21071372,"doi":"10.1148/rg.306105513"},{"pmid":21071374,"doi":"10.1148/rg.306105503"},{"pmid":21071370,"doi":"10.1148/rg.306105520"},{"pmid":21071371,"doi":"10.1148/rg.306105504"},{"pmid":21071370,"doi":"10.1148/rg.306105520"},{"pmid":21071376,"doi":"10.1148/rg.306105512"},{"pmid":21071374,"doi":"10.1148/rg.306105503"},{"pmid":21071369,"doi":"10.1148/rg.306105523"},{"pmid":21071376,"doi":"10.1148/rg.306105512"},{"pmid":21071371,"doi":"10.1148/rg.306105504"},{"pmid":21071372,"doi":"10.1148/rg.306105513"},{"pmid":21071372,"doi":"10.1148/rg.306105513"},{"pmid":21071369,"doi":"10.1148/rg.306105523"},{"pmid":21071372,"doi":"10.1148/rg.306105513"},{"pmid":21071374,"doi":"10.1148/rg.306105503"},{"pmid":21071378,"doi":"10.1148/rg.306105518"},{"pmid":21071376,"doi":"10.1148/rg.306105512"},{"pmid":21071371,"doi":"10.1148/rg.306105504"},{"pmid":21071380,"doi":"10.1148/rg.306105516"},{"pmid":21071381,"doi":"10.1148/rg.306105524"},{"pmid":21071381,"doi":"10.1148/rg.306105524"},{"pmid":21071378,"doi":"10.1148/rg.306105518"},{"pmid":21071370,"doi":"10.1148/rg.306105520"},{"pmid":21071384,"doi":"10.1148/rg.306105522"},{"pmid":21071373,"doi":"10.1148/rg.306105517"},{"pmid":21071383,"doi":"10.1148/rg.306105511"},{"pmid":21071378,"doi":"10.1148/rg.306105518"},{"pmid":21071378,"doi":"10.1148/rg.306105518"},{"pmid":21071380,"doi":"10.1148/rg.306105516"},{"pmid":21071380,"doi":"10.1148/rg.306105516"},{"pmid":21071373,"doi":"10.1148/rg.306105517"},{"pmid":21071379,"doi":"10.1148/rg.306105514"},{"pmid":21071380,"doi":"10.1148/rg.306105516"},{"pmid":21071383,"doi":"10.1148/rg.306105511"},{"pmid":21071381,"doi":"10.1148/rg.306105524"},{"pmid":21071382,"doi":"10.1148/rg.306105510"},{"pmid":21071384,"doi":"10.1148/rg.306105522"},{"pmid":21071379,"doi":"10.1148/rg.306105514"},{"pmid":21071373,"doi":"10.1148/rg.306105517"},{"pmid":21071379,"doi":"10.1148/rg.306105514"},{"pmid":21071370,"doi":"10.1148/rg.306105520"},{"pmid":21071382,"doi":"10.1148/rg.306105510"},{"pmid":21071373,"doi":"10.1148/rg.306105517"},{"pmid":21071383,"doi":"10.1148/rg.306105511"},{"pmid":21071384,"doi":"10.1148/rg.306105522"},{"pmid":21071371,"doi":"10.1148/rg.306105504"},{"pmid":21071383,"doi":"10.1148/rg.306105511"},{"pmid":21071376,"doi":"10.1148/rg.306105512"},{"pmid":21071382,"doi":"10.1148/rg.306105510"},{"pmid":21071381,"doi":"10.1148/rg.306105524"},{"pmid":21071378,"doi":"10.1148/rg.306105518"},{"pmid":21071379,"doi":"10.1148/rg.306105514"},{"pmid":21071380,"doi":"10.1148/rg.306105516"},{"pmid":21071384,"doi":"10.1148/rg.306105522"},{"pmid":21071385,"doi":"10.1148/rg.306105508"},{"pmid":21071379,"doi":"10.1148/rg.306105514"},{"pmid":21071384,"doi":"10.1148/rg.306105522"},{"pmid":21071385,"doi":"10.1148/rg.306105508"},{"pmid":21071385,"doi":"10.1148/rg.306105508"},{"pmid":21071381,"doi":"10.1148/rg.306105524"},{"pmid":21071385,"doi":"10.1148/rg.306105508"},{"pmid":21071383,"doi":"10.1148/rg.306105511"},{"pmid":21071373,"doi":"10.1148/rg.306105517"},{"pmid":21071382,"doi":"10.1148/rg.306105510"},{"pmid":21071385,"doi":"10.1148/rg.306105508"},{"pmid":21071382,"doi":"10.1148/rg.306105510"},{"pmid":21078815,"doi":"10.1148/rg.e44"},{"pmid":21078815,"doi":"10.1148/rg.e44"},{"pmid":21078815,"doi":"10.1148/rg.e44"},{"pmid":21078815,"doi":"10.1148/rg.e44"},{"pmid":21257930,"doi":"10.1148/rg.311105041"},{"pmid":21257934,"doi":"10.1148/rg.311105036"},{"pmid":21257930,"doi":"10.1148/rg.311105041"},{"pmid":21257934,"doi":"10.1148/rg.311105036"},{"pmid":21257930,"doi":"10.1148/rg.311105041"},{"pmid":21257930,"doi":"10.1148/rg.311105041"},{"pmid":21257939,"doi":"10.1148/rg.311105072"},{"pmid":21257940,"doi":"10.1148/rg.311105093"},{"pmid":21257938,"doi":"10.1148/rg.311105050"},{"pmid":21257939,"doi":"10.1148/rg.311105072"},{"pmid":21257936,"doi":"10.1148/rg.311105110"},{"pmid":21257938,"doi":"10.1148/rg.311105050"},{"pmid":21257940,"doi":"10.1148/rg.311105093"},{"pmid":21257941,"doi":"10.1148/rg.311105502"},{"pmid":21257936,"doi":"10.1148/rg.311105110"},{"pmid":21257942,"doi":"10.1148/rg.311105033"},{"pmid":21257934,"doi":"10.1148/rg.311105036"},{"pmid":21257934,"doi":"10.1148/rg.311105036"},{"pmid":21257941,"doi":"10.1148/rg.311105502"},{"pmid":21257930,"doi":"10.1148/rg.311105041"},{"pmid":21257938,"doi":"10.1148/rg.311105050"},{"pmid":21257933,"doi":"10.1148/rg.311105114"},{"pmid":21257932,"doi":"10.1148/rg.311105084"},{"pmid":21257945,"doi":"10.1148/rg.311105099"},{"pmid":21257939,"doi":"10.1148/rg.311105072"},{"pmid":21257933,"doi":"10.1148/rg.311105114"},{"pmid":21257933,"doi":"10.1148/rg.311105114"},{"pmid":21257939,"doi":"10.1148/rg.311105072"},{"pmid":21257941,"doi":"10.1148/rg.311105502"},{"pmid":21257940,"doi":"10.1148/rg.311105093"},{"pmid":21257936,"doi":"10.1148/rg.311105110"},{"pmid":21257942,"doi":"10.1148/rg.311105033"},{"pmid":21257945,"doi":"10.1148/rg.311105099"},{"pmid":21257938,"doi":"10.1148/rg.311105050"},{"pmid":21257934,"doi":"10.1148/rg.311105036"},{"pmid":21257936,"doi":"10.1148/rg.311105110"},{"pmid":21257933,"doi":"10.1148/rg.311105114"},{"pmid":21257933,"doi":"10.1148/rg.311105114"},{"pmid":21257941,"doi":"10.1148/rg.311105502"},{"pmid":21257940,"doi":"10.1148/rg.311105093"},{"pmid":21257940,"doi":"10.1148/rg.311105093"},{"pmid":21257942,"doi":"10.1148/rg.311105033"},{"pmid":21257932,"doi":"10.1148/rg.311105084"},{"pmid":21257942,"doi":"10.1148/rg.311105033"},{"pmid":21257945,"doi":"10.1148/rg.311105099"},{"pmid":21257932,"doi":"10.1148/rg.311105084"},{"pmid":21257938,"doi":"10.1148/rg.311105050"},{"pmid":21257939,"doi":"10.1148/rg.311105072"},{"pmid":21257932,"doi":"10.1148/rg.311105084"},{"pmid":21257944,"doi":"10.1148/rg.311105049"},{"pmid":21257944,"doi":"10.1148/rg.311105049"},{"pmid":21257945,"doi":"10.1148/rg.311105099"},{"pmid":21257944,"doi":"10.1148/rg.311105049"},{"pmid":21257944,"doi":"10.1148/rg.311105049"},{"pmid":21257944,"doi":"10.1148/rg.311105049"},{"pmid":21415178,"doi":"10.1148/rg.312105129"},{"pmid":21415186,"doi":"10.1148/rg.312105080"},{"pmid":21415179,"doi":"10.1148/rg.312105075"},{"pmid":21415181,"doi":"10.1148/rg.312105122"},{"pmid":21415185,"doi":"10.1148/rg.312105056"},{"pmid":21415187,"doi":"10.1148/rg.312105123"},{"pmid":21415189,"doi":"10.1148/rg.312105069"},{"pmid":21415192,"doi":"10.1148/rg.312095160"},{"pmid":21415183,"doi":"10.1148/rg.312105107"},{"pmid":21415196,"doi":"10.1148/rg.312105144"},{"pmid":21415197,"doi":"10.1148/rg.312105713"},{"pmid":21415184,"doi":"10.1148/rg.312095765"},{"pmid":21571649,"doi":"10.1148/rg.313105057"},{"pmid":21571648,"doi":"10.1148/rg.313105066"},{"pmid":21571652,"doi":"10.1148/rg.313105070"},{"pmid":21571650,"doi":"10.1148/rg.313105038"},{"pmid":21571651,"doi":"10.1148/rg.313105139"},{"pmid":21571656,"doi":"10.1148/rg.313105096"},{"pmid":21571655,"doi":"10.1148/rg.313105509"},{"pmid":21571658,"doi":"10.1148/rg.313105138"},{"pmid":21571661,"doi":"10.1148/rg.313105115"},{"pmid":21571660,"doi":"10.1148/rg.313105079"},{"pmid":21571657,"doi":"10.1148/rg.313105507"},{"pmid":21571662,"doi":"10.1148/rg.313105155"},{"pmid":21719719,"doi":"10.1148/rg.315105242"},{"pmid":21721196,"doi":"10.1148/rg.313105206"},{"pmid":21721197,"doi":"10.1148/rg.313105174"},{"pmid":21768231,"doi":"10.1148/rg.314105104"},{"pmid":21768229,"doi":"10.1148/rg.314095177"},{"pmid":21768242,"doi":"10.1148/rg.314105729"},{"pmid":21768243,"doi":"10.1148/rg.314105180"},{"pmid":21768244,"doi":"10.1148/rg.314105177"},{"pmid":21918038,"doi":"10.1148/rg.315105014"},{"pmid":21918039,"doi":"10.1148/rg.315105062"},{"pmid":21918049,"doi":"10.1148/rg.315115510"},{"pmid":21918044,"doi":"10.1148/rg.315105222"},{"pmid":21918046,"doi":"10.1148/rg.315105089"},{"pmid":21918045,"doi":"10.1148/rg.315115003"},{"pmid":21918050,"doi":"10.1148/rg.315105735"},{"pmid":21918048,"doi":"10.1148/rg.315105712"},{"pmid":21918043,"doi":"10.1148/rg.315115028"},{"pmid":21918051,"doi":"10.1148/rg.315095108"},{"pmid":21918052,"doi":"10.1148/rg.315105221"},{"pmid":21918055,"doi":"10.1148/rg.315105238"},{"pmid":21918053,"doi":"10.1148/rg.315105229"},{"pmid":21918047,"doi":"10.1148/rg.315105213"},{"pmid":21997978,"doi":"10.1148/rg.316115501"},{"pmid":21997979,"doi":"10.1148/rg.316105207"},{"pmid":21997982,"doi":"10.1148/rg.316115519"},{"pmid":21997988,"doi":"10.1148/rg.316115529"},{"pmid":21997986,"doi":"10.1148/rg.316115507"},{"pmid":21997984,"doi":"10.1148/rg.316115526"},{"pmid":21997989,"doi":"10.1148/rg.316115521"},{"pmid":21997981,"doi":"10.1148/rg.316115528"},{"pmid":21997983,"doi":"10.1148/rg.316115531"},{"pmid":21997987,"doi":"10.1148/rg.316115516"},{"pmid":21997980,"doi":"10.1148/rg.316115527"},{"pmid":21997991,"doi":"10.1148/rg.316115512"},{"pmid":21997994,"doi":"10.1148/rg.316115515"},{"pmid":21997993,"doi":"10.1148/rg.316115523"},{"pmid":21997995,"doi":"10.1148/rg.316115502"},{"pmid":22084176,"doi":"10.1148/rg.317115093"},{"pmid":22084180,"doi":"10.1148/rg.317115095"},{"pmid":22236907,"doi":"10.1148/rg.321115014"},{"pmid":22236898,"doi":"10.1148/rg.321105733"},{"pmid":22323618,"doi":"10.1148/rg.322115058"},{"pmid":22323617,"doi":"10.1148/rg.322115128"},{"pmid":22411936,"doi":"10.1148/rg.322115068"},{"pmid":22411937,"doi":"10.1148/rg.322115065"},{"pmid":22411935,"doi":"10.1148/rg.322115057"},{"pmid":22411944,"doi":"10.1148/rg.322115082"},{"pmid":22411938,"doi":"10.1148/rg.322115125"},{"pmid":22411941,"doi":"10.1148/rg.322115032"},{"pmid":22411939,"doi":"10.1148/rg.322115122"},{"pmid":22411940,"doi":"10.1148/rg.322115144"},{"pmid":22411942,"doi":"10.1148/rg.322115097"},{"pmid":22411943,"doi":"10.1148/rg.322115024"},{"pmid":22582356,"doi":"10.1148/rg.323115129"},{"pmid":22582364,"doi":"10.1148/rg.323115110"},{"pmid":22786987,"doi":"10.1148/rg.324105181"},{"pmid":22786997,"doi":"10.1148/rg.324115072"},{"pmid":22787005,"doi":"10.1148/rg.324115134"},{"pmid":22977037,"doi":"10.1148/rg.325115105"},{"pmid":22977029,"doi":"10.1148/rg.325115153"},{"pmid":22977038,"doi":"10.1148/rg.325115133"},{"pmid":23065159,"doi":"10.1148/rg.326125513"},{"pmid":23065161,"doi":"10.1148/rg.326125512"},{"pmid":23065160,"doi":"10.1148/rg.326125507"},{"pmid":23065163,"doi":"10.1148/rg.326125501"},{"pmid":23065162,"doi":"10.1148/rg.326125503"},{"pmid":23065165,"doi":"10.1148/rg.326125516"},{"pmid":23065172,"doi":"10.1148/rg.326125510"},{"pmid":23065174,"doi":"10.1148/rg.326125517"},{"pmid":23065171,"doi":"10.1148/rg.326125508"},{"pmid":23065173,"doi":"10.1148/rg.326125515"},{"pmid":23065166,"doi":"10.1148/rg.326125524"},{"pmid":23065170,"doi":"10.1148/rg.326125519"},{"pmid":23065167,"doi":"10.1148/rg.326125514"},{"pmid":23065168,"doi":"10.1148/rg.326125520"},{"pmid":23065169,"doi":"10.1148/rg.326125511"},{"pmid":22411947,"doi":"10.1148/rg.322115135"},{"pmid":22411951,"doi":"10.1148/rg.322115017"},{"pmid":22411950,"doi":"10.1148/rg.322115127"},{"pmid":22411949,"doi":"10.1148/rg.322105143"},{"pmid":22411948,"doi":"10.1148/rg.322115022"},{"pmid":23150848,"doi":"10.1148/rg.327125003"},{"pmid":23150858,"doi":"10.1148/rg.327125708"},{"pmid":23150864,"doi":"10.1148/rg.327125053"},{"pmid":23104971,"doi":"10.1148/rg.331125023"},{"pmid":23322825,"doi":"10.1148/rg.331125192"},{"pmid":23322827,"doi":"10.1148/rg.331115747"},{"pmid":23322828,"doi":"10.1148/rg.331125090"},{"pmid":23322826,"doi":"10.1148/rg.331125033"},{"pmid":23322829,"doi":"10.1148/rg.331125037"},{"pmid":23322824,"doi":"10.1148/rg.331125080"},{"pmid":23322836,"doi":"10.1148/rg.331125052"},{"pmid":23322834,"doi":"10.1148/rg.331125097"},{"pmid":23322835,"doi":"10.1148/rg.331125016"},{"pmid":23322833,"doi":"10.1148/rg.331125044"},{"pmid":23322837,"doi":"10.1148/rg.331125089"},{"pmid":23322838,"doi":"10.1148/rg.331125092"},{"pmid":23322840,"doi":"10.1148/rg.331125174"},{"pmid":23322845,"doi":"10.1148/rg.331125071"},{"pmid":23322846,"doi":"10.1148/rg.331125172"},{"pmid":12861071,"doi":"10.1148/rg.e13"},{"pmid":12920179,"doi":"10.1148/rg.e14"},{"pmid":12939473,"doi":"10.1148/rg.e15"},{"pmid":12975500,"doi":"10.1148/rg.235035702"},{"pmid":12975501,"doi":"10.1148/rg.235035701"},{"pmid":12975502,"doi":"10.1148/rg.235035031"},{"pmid":12975504,"doi":"10.1148/rg.235035013"},{"pmid":12975505,"doi":"10.1148/rg.235035029"},{"pmid":12975507,"doi":"10.1148/rg.235035040"},{"pmid":12975508,"doi":"10.1148/rg.235035004"},{"pmid":12975509,"doi":"10.1148/rg.235025046"},{"pmid":12975510,"doi":"10.1148/rg.235025045"},{"pmid":12975513,"doi":"10.1148/rg.235035134"},{"pmid":12975517,"doi":"10.1148/rg.235035059"},{"pmid":12975518,"doi":"10.1148/rg.235035080"},{"pmid":14527992,"doi":"10.1148/rg.e18"},{"pmid":14557498,"doi":"10.1148/rg.23si035505"},{"pmid":14557499,"doi":"10.1148/rg.23si035513"},{"pmid":14557500,"doi":"10.1148/rg.23si035508"},{"pmid":14557503,"doi":"10.1148/rg.23si035515"},{"pmid":14557504,"doi":"10.1148/rg.23si035506"},{"pmid":14557505,"doi":"10.1148/rg.23si035507"},{"pmid":14557506,"doi":"10.1148/rg.23si035514"},{"pmid":14557507,"doi":"10.1148/rg.23si035512"},{"pmid":14557509,"doi":"10.1148/rg.23si035501"},{"pmid":14557510,"doi":"10.1148/rg.23si035504"},{"pmid":14557511,"doi":"10.1148/rg.23si035503"},{"pmid":14597777,"doi":"10.1148/rg.e19"},{"pmid":14610245,"doi":"10.1148/rg.e17"},{"pmid":14615550,"doi":"10.1148/rg.236025056"},{"pmid":14615552,"doi":"10.1148/rg.236025172"},{"pmid":14615553,"doi":"10.1148/rg.236025115"},{"pmid":14615554,"doi":"10.1148/rg.236035033"},{"pmid":14615555,"doi":"10.1148/rg.236035085"},{"pmid":14615558,"doi":"10.1148/rg.236025174"},{"pmid":14615559,"doi":"10.1148/rg.236015526"},{"pmid":14615560,"doi":"10.1148/rg.236015527"},{"pmid":14615561,"doi":"10.1148/rg.236035101"},{"pmid":14615562,"doi":"10.1148/rg.1103035043"},{"pmid":14615563,"doi":"10.1148/rg.236035704"},{"pmid":14615565,"doi":"10.1148/rg.1103035010"},{"pmid":14615566,"doi":"10.1148/rg.236035159"},{"pmid":14615567,"doi":"10.1148/rg.236035168"},{"pmid":14615571,"doi":"10.1148/rg.236035163"},{"pmid":14730031,"doi":"10.1148/rg.241035050"},{"pmid":14730033,"doi":"10.1148/rg.241035028"},{"pmid":14730035,"doi":"10.1148/rg.241025144"},{"pmid":14730036,"doi":"10.1148/rg.241035002"},{"pmid":14730038,"doi":"10.1148/rg.241035081"},{"pmid":14730039,"doi":"10.1148/rg.241035076"},{"pmid":14730040,"doi":"10.1148/rg.241035058"},{"pmid":14730041,"doi":"10.1148/rg.241025713"},{"pmid":14730043,"doi":"10.1148/rg.241035052"},{"pmid":14730045,"doi":"10.1148/rg.241035063"},{"pmid":14730046,"doi":"10.1148/rg.241035061"},{"pmid":14730047,"doi":"10.1148/rg.241035078"},{"pmid":14730048,"doi":"10.1148/rg.241035178"},{"pmid":14730051,"doi":"10.1148/rg.241035185"},{"pmid":14730053,"doi":"10.1148/rg.241035127"},{"pmid":14730055,"doi":"10.1148/rg.241035137"},{"pmid":14730056,"doi":"10.1148/rg.e20"},{"pmid":15026585,"doi":"10.1148/rg.242035131"},{"pmid":15026586,"doi":"10.1148/rg.242035072"},{"pmid":15026587,"doi":"10.1148/rg.242035079"},{"pmid":15026588,"doi":"10.1148/rg.242035082"},{"pmid":15026589,"doi":"10.1148/rg.242035114"},{"pmid":15026591,"doi":"10.1148/rg.242035075"},{"pmid":15026592,"doi":"10.1148/rg.242035092"},{"pmid":15026593,"doi":"10.1148/rg.242035104"},{"pmid":15026594,"doi":"10.1148/rg.242035117"},{"pmid":15026595,"doi":"10.1148/rg.242025714"},{"pmid":15026596,"doi":"10.1148/rg.242035130"},{"pmid":15026597,"doi":"10.1148/rg.242035105"},{"pmid":15026598,"doi":"10.1148/rg.242025724"},{"pmid":15026600,"doi":"10.1148/rg.242035193"},{"pmid":15026601,"doi":"10.1148/rg.242035187"},{"pmid":15026605,"doi":"10.1148/rg.242035119"},{"pmid":15026606,"doi":"10.1148/rg.242035089"},{"pmid":15143219,"doi":"10.1148/rg.243035126"},{"pmid":15143220,"doi":"10.1148/rg.243035139"},{"pmid":15143221,"doi":"10.1148/rg.243035087"},{"pmid":15143222,"doi":"10.1148/rg.243035120"},{"pmid":15143223,"doi":"10.1148/rg.243035084"},{"pmid":15143224,"doi":"10.1148/rg.243035100"},{"pmid":15143225,"doi":"10.1148/rg.243035107"},{"pmid":15143226,"doi":"10.1148/rg.243035046"},{"pmid":15143227,"doi":"10.1148/rg.243035096"},{"pmid":15143228,"doi":"10.1148/rg.243035502"},{"pmid":15143229,"doi":"10.1148/rg.243035091"},{"pmid":15143230,"doi":"10.1148/rg.243035086"},{"pmid":15143231,"doi":"10.1148/rg.243045005"},{"pmid":15143234,"doi":"10.1148/rg.243035153"},{"pmid":15143236,"doi":"10.1148/rg.243035190"},{"pmid":15143237,"doi":"10.1148/rg.243035133"},{"pmid":15143238,"doi":"10.1148/rg.243035710"},{"pmid":15143239,"doi":"10.1148/rg.243035722"},{"pmid":15256618,"doi":"10.1148/rg.244035158"},{"pmid":15256619,"doi":"10.1148/rg.244035719"},{"pmid":15256620,"doi":"10.1148/rg.244035186"},{"pmid":15256621,"doi":"10.1148/rg.244035166"},{"pmid":15256622,"doi":"10.1148/rg.244035160"},{"pmid":15256624,"doi":"10.1148/rg.244035723"},{"pmid":15256625,"doi":"10.1148/rg.244045015"},{"pmid":15256627,"doi":"10.1148/rg.244035151"},{"pmid":15256628,"doi":"10.1148/rg.244035726"},{"pmid":15256629,"doi":"10.1148/rg.244985082"},{"pmid":15256630,"doi":"10.1148/rg.244035035"},{"pmid":15256632,"doi":"10.1148/rg.244035718"},{"pmid":15256633,"doi":"10.1148/rg.244035149"},{"pmid":15256634,"doi":"10.1148/rg.244045006"},{"pmid":15256635,"doi":"10.1148/rg.244035164"},{"pmid":15256636,"doi":"10.1148/rg.244035222"},{"pmid":15256638,"doi":"10.1148/rg.244035179"},{"pmid":15371604,"doi":"10.1148/rg.245045008"},{"pmid":15371605,"doi":"10.1148/rg.245035728"},{"pmid":15371606,"doi":"10.1148/rg.245045014"},{"pmid":15371608,"doi":"10.1148/rg.245035062"},{"pmid":15371609,"doi":"10.1148/rg.245035734"},{"pmid":15371610,"doi":"10.1148/rg.245045036"},{"pmid":15371611,"doi":"10.1148/rg.245045048"},{"pmid":15371612,"doi":"10.1148/rg.245035219"},{"pmid":15371613,"doi":"10.1148/rg.245045017"},{"pmid":15371614,"doi":"10.1148/rg.245035224"},{"pmid":15371615,"doi":"10.1148/rg.245045002"},{"pmid":15371616,"doi":"10.1148/rg.245045009"},{"pmid":15371617,"doi":"10.1148/rg.245035725"},{"pmid":15371618,"doi":"10.1148/rg.245045120"},{"pmid":15371622,"doi":"10.1148/rg.245045020"},{"pmid":15371625,"doi":"10.1148/rg.245035212"},{"pmid":15486234,"doi":"10.1148/rg.24si045515"},{"pmid":15486235,"doi":"10.1148/rg.24si045505"},{"pmid":15486236,"doi":"10.1148/rg.24si045503"},{"pmid":15486237,"doi":"10.1148/rg.24si045507"},{"pmid":15486238,"doi":"10.1148/rg.24si045501"},{"pmid":15486239,"doi":"10.1148/24si045516"},{"pmid":15486240,"doi":"10.1148/rg.24si045502"},{"pmid":15486241,"doi":"10.1148/rg.24si045504"},{"pmid":15486242,"doi":"10.1148/rg.24si045508"},{"pmid":15486245,"doi":"10.1148/rg.24si045509"},{"pmid":15486248,"doi":"10.1148/rg.24si045513"},{"pmid":15486250,"doi":"10.1148/rg.24si045512"},{"pmid":15486251,"doi":"10.1148/rg.24si045514"},{"pmid":15486252,"doi":"10.1148/rg.24si045506"},{"pmid":15537963,"doi":"10.1148/rg.246045063"},{"pmid":15537965,"doi":"10.1148/rg.246045033"},{"pmid":15537966,"doi":"10.1148/rg.246045016"},{"pmid":15537967,"doi":"10.1148/rg.246045028"},{"pmid":15537971,"doi":"10.1148/rg.246045701"},{"pmid":15537974,"doi":"10.1148/rg.246045026"},{"pmid":15537975,"doi":"10.1148/rg.246045034"},{"pmid":15537977,"doi":"10.1148/rg.246045146"},{"pmid":15653583,"doi":"10.1148/rg.251045511"},{"pmid":15653584,"doi":"10.1148/rg.251045060"},{"pmid":15653586,"doi":"10.1148/rg.251045085"},{"pmid":15653588,"doi":"10.1148/rg.251045074"},{"pmid":15653589,"doi":"10.1148/rg.251045079"},{"pmid":15653590,"doi":"10.1148/rg.251045050"},{"pmid":15653591,"doi":"10.1148/rg.251045510"},{"pmid":15653592,"doi":"10.1148/rg.251045043"},{"pmid":15653593,"doi":"10.1148/rg.251045046"},{"pmid":15653594,"doi":"10.1148/rg.251045078"},{"pmid":15653595,"doi":"10.1148/rg.251045045"},{"pmid":15653597,"doi":"10.1148/rg.251045156"},{"pmid":15798050,"doi":"10.1148/rg.252045037"},{"pmid":15798052,"doi":"10.1148/rg.252045083"},{"pmid":15798053,"doi":"10.1148/rg.252045066"},{"pmid":15798054,"doi":"10.1148/rg.252045108"},{"pmid":15798056,"doi":"10.1148/rg.252045073"},{"pmid":15798057,"doi":"10.1148/rg.252045111"},{"pmid":15798058,"doi":"10.1148/rg.252045709"},{"pmid":15798059,"doi":"10.1148/rg.252045077"},{"pmid":15798060,"doi":"10.1148/rg.252045098"},{"pmid":15798062,"doi":"10.1148/rg.252045075"},{"pmid":15798063,"doi":"10.1148/rg.252045176"},{"pmid":15798064,"doi":"10.1148/rg.252045153"},{"pmid":15798066,"doi":"10.1148/rg.252045185"},{"pmid":15798068,"doi":"10.1148/rg.252045070"},{"pmid":15888608,"doi":"10.1148/rg.253045117"},{"pmid":15888610,"doi":"10.1148/rg.253045711"},{"pmid":15888611,"doi":"10.1148/rg.253045123"},{"pmid":15888612,"doi":"10.1148/rg.253045092"},{"pmid":15888613,"doi":"10.1148/rg.253045118"},{"pmid":15888614,"doi":"10.1148/rg.253045124"},{"pmid":15888615,"doi":"10.1148/rg.253045103"},{"pmid":15888616,"doi":"10.1148/rg.253045114"},{"pmid":15888617,"doi":"10.1148/rg.253045104"},{"pmid":15888619,"doi":"10.1148/rg.253045134"},{"pmid":15888621,"doi":"10.1148/rg.253045145"},{"pmid":15888622,"doi":"10.1148/rg.253045100"},{"pmid":15888623,"doi":"10.1148/rg.253045067"},{"pmid":15888624,"doi":"10.1148/rg.253045030"},{"pmid":15888626,"doi":"10.1148/rg.253045115"},{"pmid":16009813,"doi":"10.1148/rg.254045151"},{"pmid":16009814,"doi":"10.1148/rg.254035156"},{"pmid":16009815,"doi":"10.1148/rg.254045136"},{"pmid":16009816,"doi":"10.1148/rg.254045142"},{"pmid":16009817,"doi":"10.1148/rg.254045167"},{"pmid":16009818,"doi":"10.1148/rg.254045154"},{"pmid":16009819,"doi":"10.1148/rg.254045140"},{"pmid":16009821,"doi":"10.1148/rg.254045032"},{"pmid":16009822,"doi":"10.1148/rg.254045155"},{"pmid":16009823,"doi":"10.1148/rg.254055019"},{"pmid":16160101,"doi":"10.1148/rg.255055014"},{"pmid":16160102,"doi":"10.1148/rg.255045019"},{"pmid":16160104,"doi":"10.1148/rg.255055001"},{"pmid":16160105,"doi":"10.1148/rg.255055011"},{"pmid":16160107,"doi":"10.1148/rg.255045713"},{"pmid":16160108,"doi":"10.1148/rg.255045160"},{"pmid":16160109,"doi":"10.1148/rg.255045162"},{"pmid":16160110,"doi":"10.1148/rg.255045721"},{"pmid":16160112,"doi":"10.1148/rg.255045202"},{"pmid":16160113,"doi":"10.1148/rg.255045180"},{"pmid":16160114,"doi":"10.1148/rg.255045184"},{"pmid":16160115,"doi":"10.1148/rg.255045133"},{"pmid":16160116,"doi":"10.1148/rg.255045122"},{"pmid":16160117,"doi":"10.1148/rg.255055106"},{"pmid":16160120,"doi":"10.1148/rg.255055044"},{"pmid":16227486,"doi":"10.1148/rg.25si055518"},{"pmid":16227487,"doi":"10.1148/rg.25si055511"},{"pmid":16227488,"doi":"10.1148/rg.25si055514"},{"pmid":16227489,"doi":"10.1148/rg.25si055509"},{"pmid":16227490,"doi":"10.1148/rg.25si055503"},{"pmid":16227491,"doi":"10.1148/rg.25si055504"},{"pmid":16227492,"doi":"10.1148/rg.25si055517"},{"pmid":16227493,"doi":"10.1148/rg.25si055513"},{"pmid":16227495,"doi":"10.1148/rg.25si055507"},{"pmid":16227496,"doi":"10.1148/rg.25si055515"},{"pmid":16227497,"doi":"10.1148/rg.25si055505"},{"pmid":16227498,"doi":"10.1148/rg.25si055501"},{"pmid":16227499,"doi":"10.1148/rg.25si055512"},{"pmid":16227501,"doi":"10.1148/rg.25si055510"},{"pmid":16278344,"doi":"10.1148/rg.e22"},{"pmid":16284127,"doi":"10.1148/rg.256055036"},{"pmid":16284129,"doi":"10.1148/rg.256045161"},{"pmid":16284130,"doi":"10.1148/rg.256055016"},{"pmid":16284131,"doi":"10.1148/rg.256055018"},{"pmid":16284132,"doi":"10.1148/rg.256055030"},{"pmid":16284133,"doi":"10.1148/rg.256045052"},{"pmid":16284135,"doi":"10.1148/rg.256045013"},{"pmid":16284137,"doi":"10.1148/rg.256045203"},{"pmid":16284138,"doi":"10.1148/rg.256045517"},{"pmid":16284139,"doi":"10.1148/rg.256055069"},{"pmid":16284141,"doi":"10.1148/rg.256055516"},{"pmid":16284142,"doi":"10.1148/rg.256055137"},{"pmid":16352733,"doi":"10.1148/rg.e23"},{"pmid":16418239,"doi":"10.1148/rg.261045726"},{"pmid":16418240,"doi":"10.1148/rg.261055062"},{"pmid":16418242,"doi":"10.1148/rg.261055057"},{"pmid":16418244,"doi":"10.1148/rg.261055070"},{"pmid":16418245,"doi":"10.1148/rg.261055034"},{"pmid":16418246,"doi":"10.1148/rg.261055045"},{"pmid":16418247,"doi":"10.1148/rg.261055703"},{"pmid":16418249,"doi":"10.1148/rg.261055078"},{"pmid":16418250,"doi":"10.1148/rg.261055050"},{"pmid":16418251,"doi":"10.1148/rg.261055033"},{"pmid":16418252,"doi":"10.1148/rg.261055064"},{"pmid":16418253,"doi":"10.1148/rg.261055058"},{"pmid":16418255,"doi":"10.1148/rg.261055151"},{"pmid":16418258,"doi":"10.1148/rg.261055134"},{"pmid":16549600,"doi":"10.1148/rg.262055068"},{"pmid":16549602,"doi":"10.1148/rg.262045213"},{"pmid":16549603,"doi":"10.1148/rg.262055092"},{"pmid":16549604,"doi":"10.1148/rg.262055039"},{"pmid":16549605,"doi":"10.1148/rg.262055059"},{"pmid":16549606,"doi":"10.1148/rg.262055041"},{"pmid":16549607,"doi":"10.1148/rg.262055109"},{"pmid":16549608,"doi":"10.1148/rg.262055073"},{"pmid":16549609,"doi":"10.1148/rg.262055056"},{"pmid":16549611,"doi":"10.1148/rg.262055097"},{"pmid":16549613,"doi":"10.1148/rg.262055138"},{"pmid":16549614,"doi":"10.1148/rg.262055063"},{"pmid":16549617,"doi":"10.1148/rg.262055172"},{"pmid":16549619,"doi":"10.1148/rg.262045719"},{"pmid":16702444,"doi":"10.1148/rg.263055162"},{"pmid":16702446,"doi":"10.1148/rg.263055077"},{"pmid":16702447,"doi":"10.1148/rg.263055101"},{"pmid":16702448,"doi":"10.1148/rg.263055714"},{"pmid":16702449,"doi":"10.1148/rg.263055086"},{"pmid":16702450,"doi":"10.1148/rg.263055164"},{"pmid":16702451,"doi":"10.1148/rg.263055100"},{"pmid":16702452,"doi":"10.1148/rg.263055024"},{"pmid":16702453,"doi":"10.1148/rg.263055091"},{"pmid":16702454,"doi":"10.1148/rg.263045710"},{"pmid":16702455,"doi":"10.1148/rg.263055047"},{"pmid":16702456,"doi":"10.1148/rg.263055113"},{"pmid":16702458,"doi":"10.1148/rg.263055102"},{"pmid":16702459,"doi":"10.1148/rg.263055139"},{"pmid":16702460,"doi":"10.1148/rg.263055099"},{"pmid":16702461,"doi":"10.1148/rg.263055182"},{"pmid":16702462,"doi":"10.1148/rg.263055186"},{"pmid":16702463,"doi":"10.1148/rg.263055211"},{"pmid":16844926,"doi":"10.1148/rg.264055709"},{"pmid":16844927,"doi":"10.1148/rg.264055082"},{"pmid":16844928,"doi":"10.1148/rg.264055116"},{"pmid":16844929,"doi":"10.1148/rg.264055117"},{"pmid":16844930,"doi":"10.1148/rg.264055114"},{"pmid":16844931,"doi":"10.1148/rg.264055087"},{"pmid":16844932,"doi":"10.1148/rg.264055120"},{"pmid":16844933,"doi":"10.1148/rg.264055166"},{"pmid":16844935,"doi":"10.1148/rg.264055144"},{"pmid":16844938,"doi":"10.1148/rg.264055133"},{"pmid":16844939,"doi":"10.1148/rg.264055125"},{"pmid":16844940,"doi":"10.1148/rg.264055129"},{"pmid":16844941,"doi":"10.1148/rg.264055081"},{"pmid":16844942,"doi":"10.1148/rg.264065012"},{"pmid":16973765,"doi":"10.1148/rg.265055712"},{"pmid":16973766,"doi":"10.1148/rg.265055729"},{"pmid":16973767,"doi":"10.1148/rg.265065001"},{"pmid":16973768,"doi":"10.1148/rg.265055208"},{"pmid":16973769,"doi":"10.1148/rg.265055123"},{"pmid":16973770,"doi":"10.1148/rg.265045191"},{"pmid":16973771,"doi":"10.1148/rg.265055723"},{"pmid":16973772,"doi":"10.1148/rg.265055711"},{"pmid":16973773,"doi":"10.1148/rg.265065701"},{"pmid":16973774,"doi":"10.1148/rg.265045206"},{"pmid":16973775,"doi":"10.1148/rg.265055156"},{"pmid":16973776,"doi":"10.1148/rg.265055176"},{"pmid":16973777,"doi":"10.1148/rg.265055167"},{"pmid":16973778,"doi":"10.1148/rg.265055728"},{"pmid":16973779,"doi":"10.1148/rg.265055090"},{"pmid":16973781,"doi":"10.1148/rg.265065084"},{"pmid":17050510,"doi":"10.1148/rg.26si065502"},{"pmid":17050511,"doi":"10.1148/rg.26si065511"},{"pmid":17050512,"doi":"10.1148/rg.26si065507"},{"pmid":17050513,"doi":"10.1148/rg.26si065504"},{"pmid":17050514,"doi":"10.1148/rg.26si065513"},{"pmid":17050515,"doi":"10.1148/rg.26si055174"},{"pmid":17050516,"doi":"10.1148/rg.26si065503"},{"pmid":17050517,"doi":"10.1148/rg.26si065510"},{"pmid":17050518,"doi":"10.1148/rg.26si065508"},{"pmid":17050519,"doi":"10.1148/rg.26si065505"},{"pmid":17050520,"doi":"10.1148/rg.26si065506"},{"pmid":17050521,"doi":"10.1148/rg.26si065501"},{"pmid":17050522,"doi":"10.1148/rg.26si065512"},{"pmid":17102039,"doi":"10.1148/rg.266055730"},{"pmid":17102040,"doi":"10.1148/rg.266065014"},{"pmid":17102041,"doi":"10.1148/rg.266065004"},{"pmid":17102042,"doi":"10.1148/rg.266065013"},{"pmid":17102043,"doi":"10.1148/rg.266055199"},{"pmid":17102044,"doi":"10.1148/rg.266055732"},{"pmid":17102045,"doi":"10.1148/rg.266065048"},{"pmid":17102046,"doi":"10.1148/rg.266065025"},{"pmid":17102047,"doi":"10.1148/rg.266055079"},{"pmid":17102048,"doi":"10.1148/rg.266055189"},{"pmid":17102049,"doi":"10.1148/rg.266065035"},{"pmid":17102050,"doi":"10.1148/rg.266065063"},{"pmid":17102051,"doi":"10.1148/rg.266065010"},{"pmid":17102052,"doi":"10.1148/rg.266065057"},{"pmid":17102053,"doi":"10.1148/rg.266065039"},{"pmid":17102054,"doi":"10.1148/rg.266065079"},{"pmid":17102055,"doi":"10.1148/rg.266065126"},{"pmid":17234995,"doi":"10.1148/rg.271065027"},{"pmid":17234996,"doi":"10.1148/rg.271065089"},{"pmid":17234997,"doi":"10.1148/rg.271065073"},{"pmid":17234998,"doi":"10.1148/rg.271065037"},{"pmid":17234999,"doi":"10.1148/rg.271065078"},{"pmid":17235000,"doi":"10.1148/rg.271065029"},{"pmid":17235002,"doi":"10.1148/rg.271065042"},{"pmid":17235003,"doi":"10.1148/rg.271065050"},{"pmid":17235004,"doi":"10.1148/rg.271065080"},{"pmid":17235005,"doi":"10.1148/rg.271065074"},{"pmid":17235006,"doi":"10.1148/rg.271065065"},{"pmid":17235007,"doi":"10.1148/rg.271065092"},{"pmid":17235008,"doi":"10.1148/rg.271065064"},{"pmid":17235009,"doi":"10.1148/rg.271065076"},{"pmid":17235010,"doi":"10.1148/rg.271065169"},{"pmid":17374854,"doi":"10.1148/rg.272055098"},{"pmid":17374855,"doi":"10.1148/rg.272065088"},{"pmid":17374856,"doi":"10.1148/rg.272065083"},{"pmid":17374857,"doi":"10.1148/rg.272065119"},{"pmid":17374858,"doi":"10.1148/rg.272065117"},{"pmid":17374859,"doi":"10.1148/rg.272065101"},{"pmid":17374860,"doi":"10.1148/rg.272065061"},{"pmid":17374861,"doi":"10.1148/rg.272065034"},{"pmid":17374862,"doi":"10.1148/rg.272065081"},{"pmid":17374863,"doi":"10.1148/rg.272065058"},{"pmid":17374864,"doi":"10.1148/rg.272055148"},{"pmid":17374865,"doi":"10.1148/rg.272065026"},{"pmid":17374866,"doi":"10.1148/rg.272065082"},{"pmid":17374867,"doi":"10.1148/rg.272065155"},{"pmid":17495281,"doi":"10.1148/rg.273065130"},{"pmid":17495282,"doi":"10.1148/rg.273065051"},{"pmid":17495283,"doi":"10.1148/rg.273065122"},{"pmid":17495284,"doi":"10.1148/rg.273065136"},{"pmid":17495286,"doi":"10.1148/rg.273065075"},{"pmid":17495287,"doi":"10.1148/rg.273065036"},{"pmid":17495288,"doi":"10.1148/rg.273065085"},{"pmid":17495289,"doi":"10.1148/rg.273065116"},{"pmid":17495290,"doi":"10.1148/rg.273055031"},{"pmid":17495292,"doi":"10.1148/rg.273065055"},{"pmid":17495293,"doi":"10.1148/rg.273065087"},{"pmid":17495294,"doi":"10.1148/rg.273065031"},{"pmid":17495295,"doi":"10.1148/rg.273065713"},{"pmid":17495296,"doi":"10.1148/rg.273065038"},{"pmid":17495297,"doi":"10.1148/rg.273065194"},{"pmid":17495299,"doi":"10.1148/rg.273065153"},{"pmid":17620458,"doi":"10.1148/rg.274065149"},{"pmid":17620459,"doi":"10.1148/rg.274065103"},{"pmid":17620460,"doi":"10.1148/rg.274065144"},{"pmid":17620462,"doi":"10.1148/rg.274055188"},{"pmid":17620463,"doi":"10.1148/rg.274065171"},{"pmid":17620464,"doi":"10.1148/rg.274065142"},{"pmid":17620465,"doi":"10.1148/rg.274065047"},{"pmid":17620466,"doi":"10.1148/rg.274065164"},{"pmid":17620467,"doi":"10.1148/rg.274065095"},{"pmid":17620468,"doi":"10.1148/rg.274065722"},{"pmid":17620469,"doi":"10.1148/rg.274065123"},{"pmid":17620470,"doi":"10.1148/rg.274065135"},{"pmid":17620471,"doi":"10.1148/rg.274065147"},{"pmid":17620472,"doi":"10.1148/rg.274065150"},{"pmid":17620473,"doi":"10.1148/rg.274075014"},{"pmid":12533636,"doi":"10.1148/rg.231025018"},{"pmid":12533639,"doi":"10.1148/rg.231025037"},{"pmid":12533641,"doi":"10.1148/rg.231025078"},{"pmid":12533643,"doi":"10.1148/rg.231025071"},{"pmid":12533646,"doi":"10.1148/rg.231025055"},{"pmid":12533657,"doi":"10.1148/rg.231025133"},{"pmid":12640150,"doi":"10.1148/rg.232025705"},{"pmid":12640151,"doi":"10.1148/rg.232025103"},{"pmid":12640155,"doi":"10.1148/rg.232025100"},{"pmid":12640156,"doi":"10.1148/rg.232025089"},{"pmid":12640157,"doi":"10.1148/rg.232025065"},{"pmid":12640158,"doi":"10.1148/rg.232025030"},{"pmid":12640160,"doi":"10.1148/rg.232025081"},{"pmid":12640161,"doi":"10.1148/rg.232025704"},{"pmid":16552908,"doi":"10.1148/rg.262055183"},{"pmid":12740460,"doi":"10.1148/rg.233025121"},{"pmid":12740464,"doi":"10.1148/rg.233025053"},{"pmid":12740465,"doi":"10.1148/rg.233025127"},{"pmid":12740466,"doi":"10.1148/rg.233025134"},{"pmid":12740467,"doi":"10.1148/rg.233025712"},{"pmid":12740470,"doi":"10.1148/rg.233025105"},{"pmid":12740471,"doi":"10.1148/rg.233025150"},{"pmid":12740472,"doi":"10.1148/rg.233025073"},{"pmid":12853657,"doi":"10.1148/rg.234035030"},{"pmid":12853661,"doi":"10.1148/rg.234025716"},{"pmid":12853662,"doi":"10.1148/rg.234025149"},{"pmid":12853663,"doi":"10.1148/rg.234025083"},{"pmid":12853664,"doi":"10.1148/rg.234025717"},{"pmid":12853665,"doi":"10.1148/rg.234025044"},{"pmid":12853666,"doi":"10.1148/rg.234025135"},{"pmid":12853668,"doi":"10.1148/rg.234025160"},{"pmid":12853670,"doi":"10.1148/rg.234025097"},{"pmid":12853673,"doi":"10.1148/rg.234035001"},{"pmid":12853675,"doi":"10.1148/rg.234025163"},{"pmid":12853676,"doi":"10.1148/rg.234025176"},{"pmid":12853678,"doi":"10.1148/rg.234035034"},{"pmid":12853679,"doi":"10.1148/rg.234035011"},{"pmid":12886890,"doi":"10.1148/rg.e9"},{"pmid":12640147,"doi":"10.1148/rg.232025146"},{"pmid":12740462,"doi":"10.1148/rg.233025036"},{"pmid":12886888,"doi":"10.1148/rg.e7"},{"pmid":12889461,"doi":"10.1148/rg.e11"},{"pmid":12533638,"doi":"10.1148/rg.231025050"},{"pmid":12533651,"doi":"10.1148/rg.231015088"},{"pmid":12740473,"doi":"10.1148/rg.233025137"},{"pmid":14518449,"doi":"10.1148/rg.235035113"},{"pmid":17503550,"doi":"10.1148/radiographics.27.3.0270866"}]
    ident_already_in_db = Resource.objects.filter(type="RadioGraphics").values_list('identifier',flat=True)
    ident_already_processed = []
    for count, ident in enumerate(identifiers):
        if ident['doi'] in ident_already_in_db:
            ident_already_processed.append(ident['doi'])
            print "article # " + str(count) + " already in db"
            continue
        if ident['doi'] in ident_already_processed:
            print "article # " + str(count) + " already processed"
            continue
        doi = ident['doi']
        url = 'http://pubs.rsna.org/doi/full/%s' % doi
        try:
            sys.stdout.write("article # " + str(count) + " reading url...")
            limitReached = True
            while True:
                if not limitReached:
                    break
                try:
                    start = time()
                    r = br.open(url)
                    limitReached = False
                except:
                    limitReached = True
                    sys.stdout.write("limit reached, waiting...")
                    sleep(7200)
            entry_url = r.geturl()
            entry_html_source = r.read()
            soup = BeautifulSoup(entry_html_source.decode('utf-8'), 'html5lib')
            is_not_free = soup.find(id='accessDenialWidget')
            if is_not_free is not None:
                sys.stdout.write(str(time()-start) + " seconds")
                sys.stdout.write("...skipping, article not free.\n")
                sys.stdout.flush()
            else:
                sys.stdout.write("adding to database...")
                # format of returned list from get_metadata function:
                # 0 identifier
                # 1 type
                # 2 language
                # 3 title
                # 4 date
                # 5 publisher
                # 6 author
                # 7 journal
                # 8 volume
                # 9 issue
                # 10 firstpage
                # 11 lastpage
                # 12 url
                res_metadata = parser.get_metadata(entry_url, entry_html_source)
                res_metadata[1] = 'RadioGraphics'
                res_metadata[0] = doi
                # creates new Resource object and containing Subresource objects
                # creates Resource based on returned parser metadata
                res = Resource(identifier = res_metadata[0],
                    type = res_metadata[1],
                    language = res_metadata[2],
                    title = res_metadata[3],
                    date = res_metadata[4],
                    publisher = res_metadata[5],
                    author = res_metadata[6],
                    journal = res_metadata[7],
                    volume = res_metadata[8],
                    issue = res_metadata[9],
                    firstpage = res_metadata[10],
                    lastpage = res_metadata[11],
                    url = entry_url,
                    html_source = entry_html_source)
                res.save()
                res.user.add(9) # corresponds to admin@filopod.com
                #res.user.add(2) # corresponds to lchen3@gmail.com
                res.domain.add(1) # corresponds to Biomedical
                subres = []
                # creates Subresource objects of type 'figure'
                figures = parser.get_figures(entry_url, entry_html_source)
                for i, figure in enumerate(figures):
                    try:
                        f = urllib2.urlopen(urllib2.Request(figure[4]))
                        deadLinkFound = False
                    except:
                        deadLinkFound = True
                    if deadLinkFound:
                        url_correct = figure[3]
                    else:
                        url_correct = figure[4]
                    subres.append(Subresource(containing_resource = res,
                        name = figure[0],
                        type = 'figure',
                        content = figure[1],
                        url = url_correct))
                # creates Subresource objects of type 'paragraph'
                paragraphs = parser.get_paragraphs(entry_url, entry_html_source)
                for i, paragraph in enumerate(paragraphs):
                    subres.append(Subresource(containing_resource = res,
                        name = 'paragraph ' + str(i),
                        type = 'paragraph',
                        content = paragraph))
                subres_temp = Subresource.objects.bulk_create(subres)
                del subres_temp
                del subres
                sys.stdout.write(str(time()-start) + " seconds\n")
                sys.stdout.flush()
            ident_already_processed.append(doi)
        except Exception, e:
            print "failed. exception: "+str(e)
            traceback.print_exc()
    
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    
    sys.stdout.write("~~~~loading concepts and term lists... ")
    start = time()
    file = open('scripts\MESH_concept_and_terms_tuple.pkl','rb')
    (tot_concepts, concept_IDs, term_lists) = pickle_zloads(file.read())
    file.close()
    sys.stdout.write("%.2f" % (time()-start) + "seconds\n")
    sys.stdout.flush()
    
    res_ids = list(Resource.objects.filter(type="RadioGraphics").values_list('id',flat=True))
    print "total # of resources: " + str(len(res_ids))
    for count, res_id in enumerate(res_ids):        
        try:
            sys.stdout.write("article # " + str(count) + " processing...")
            start = time()
            target_paragraphs = Subresource.objects.filter(containing_resource_id=res_id)
            
            #create sentences from target_paragraphs
            sentences = []
            sentences_indexofparagraph = []
            tot_para = 0
            tot_sent = 0
            for para_num, target_paragraph in enumerate(target_paragraphs):
                #find all sentence in this paragraph
                tokenized_sentences = sent_tokenize(target_paragraph.content.rstrip())
                sentences.extend(tokenized_sentences)
                sentences_indexofparagraph.extend([para_num]*len(tokenized_sentences))
                tot_sent = tot_sent + len(tokenized_sentences)
                tot_para = tot_para + 1
            tot_para = len(target_paragraphs)
            
            #second go through each concept/term, find them in subresources, and process into matrix
            tc = 0
            j = 0
            row_sentence = []
            row_paragraph = []
            col_sentence = []
            col_paragraph = []
            data_sentence = []
            data_paragraph = []
            # initialize list of empty lists for storing concepts contained in each paragraph
            para_conceptIDs_contained = [[] for i in range(tot_para)]
            for i, con_ID in enumerate(concept_IDs):
                term_list = term_lists[i]
                wordcount_in_paragraphs = [0] * tot_para
                terms_regex = [r"\b"+re2.escape(term.lower())+r"\b" for term in term_list]
                search_pattern = re2.compile("|".join(terms_regex))
                for sent_num, sentence in enumerate(sentences):
                    wordcount = len(search_pattern.findall(sentence.lower()))
                    if wordcount > 0: #only go ahead if search_pattern is in the sentence
                        row_sentence.append(sent_num)
                        col_sentence.append(tc)
                        data_sentence.append(1)
                        wordcount_in_paragraphs[sentences_indexofparagraph[sent_num]] += wordcount
                for para_num in range(tot_para):
                    wordcount_in_p = wordcount_in_paragraphs[para_num]
                    if wordcount_in_p > 0:
                        row_paragraph.append(para_num)
                        col_paragraph.append(tc)
                        data_paragraph.append(1)
                        para_conceptIDs_contained[para_num].append(con_ID)
                if tc*10/tot_concepts > j:
                    percent_done = tc*10/tot_concepts*10
                    sys.stdout.write(str(percent_done) + "% ")
                    j=j+1
                tc = tc + 1
            
            # update concepts_contained fields for all subresource objects
            for para_num in range(tot_para):
                if len(para_conceptIDs_contained[para_num]) > 0:
                    target_paragraphs[para_num].concepts_contained.add(*para_conceptIDs_contained[para_num])
                    
            #create target_A matrix
            target_A_sentence = coo_matrix((array(data_sentence),(array(row_sentence),array(col_sentence))),shape=(tot_sent,tot_concepts),dtype=int16)
            #target_A_paragraph = coo_matrix((array(data_paragraph),(array(row_paragraph),array(col_paragraph))),shape=(tot_para,tot_concepts),dtype=int16)
            
            #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
            # now convert target_A into a scipy csr_matrix (sparse matrix)
            target_A_sentence = target_A_sentence.tocsr()
            #target_A_paragraph = target_A_paragraph.tocsr()
            
            # calculate AtA for target_A
            AtA_sentence = target_A_sentence.T * target_A_sentence
            #AtA_paragraph = target_A_paragraph.T * target_A_paragraph
            
            # add AtA to Big_A
            if count==0:
                bigA_AtA_sentence = AtA_sentence
                N_sentence = tot_sent
                #bigA_AtA_paragraph = AtA_paragraph
                #N_paragraph = tot_para
            else:
                bigA_AtA_sentence = bigA_AtA_sentence + AtA_sentence
                N_sentence = N_sentence + tot_sent
                #bigA_AtA_paragraph = bigA_AtA_paragraph + AtA_paragraph
                #N_paragraph = N_paragraph + tot_para
            
            sys.stdout.write(str(time()-start) + " seconds\n")
            sys.stdout.flush()
        except Exception, e:
            print "failed. exception: "+str(e)
            traceback.print_exc()
    
    #~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    sys.stdout.write("files saving...")
    start = time()
    
    bigA_AtA_sentence_path = 'matrices/RadioGraphics_bigA_AtA_sentence.pkl'
    bigA_AtA_sentence_file = default_storage.open(bigA_AtA_sentence_path,'wb')
    mf = MatrixFiles(name='RadioGraphics', type='AtA_sentence', path=bigA_AtA_sentence_path)
    mf.save()
    mf.user.add(9) # corresponds to admin@filopod.com
    bigA_AtA_sentence_tuple = (bigA_AtA_sentence, N_sentence)
    bigA_AtA_sentence_file.write(pickle_zdumps(bigA_AtA_sentence_tuple))
    bigA_AtA_sentence_file.close()
    
    #bigA_AtA_paragraph_path = 'matrices/RadioGraphics_bigA_AtA_paragraph.pkl'
    #bigA_AtA_paragraph_file = default_storage.open(bigA_AtA_paragraph_path,'wb')
    #mf = MatrixFiles(name='RadioGraphics', type='AtA_paragraph', path=bigA_AtA_paragraph_path)
    #mf.save()
    #mf.user.add(9) # corresponds to admin@filopod.com
    #bigA_AtA_paragraph_tuple = (bigA_AtA_paragraph, N_paragraph)
    #bigA_AtA_paragraph_file.write(pickle_zdumps(bigA_AtA_paragraph_tuple))
    #bigA_AtA_paragraph_file.close()
    
    sys.stdout.write("......" + str(time()-start) + " seconds\n")
    sys.stdout.flush()